import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as t,o as c,c as i,b as e,e as n,d as s,a as r}from"./app-D1uezr0R.js";const d="/assets/true-image-20220829220406490-BpvOMZoW.png",o={},h=e("p",null,"k8s 可视化管理工具-Rancher",-1),p=e("p",null,[n("Rancher 是一个开源的容器管理平台，它可以与多个 Kubernetes 集群进行集中化管理。Rancher 提供了直观的界面来创建、部署和监控 Kubernetes 集群，并支持集群间的负载均衡和流量管理。它还提供了强大的权限管理和安全功能，适用于企业级场景。"),e("strong",null,"如果你需要在多个 Kubernetes 集群之间进行管理，并且关注高可用性、安全性和集群间通信等方面，Rancher 是一个不错的选择。")],-1),u={href:"https://rancher.com/",target:"_blank",rel:"noopener noreferrer"},m={href:"https://www.rancher.cn/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/rancher/rancher",target:"_blank",rel:"noopener noreferrer"},b=e("strong",null,"star:22.4+K",-1),g={href:"https://gitee.com/k8s_s/rancher",target:"_blank",rel:"noopener noreferrer"},k={href:"https://hub.docker.com/r/rancher/rancher/tags",target:"_blank",rel:"noopener noreferrer"},_=e("figure",null,[e("img",{src:d,alt:"",tabindex:"0",loading:"lazy"}),e("figcaption")],-1),f=e("h2",{id:"安装2-8-2",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#安装2-8-2"},[e("span",null,"安装2.8.2")])],-1),y=e("p",null,"查看支持的 k8s 版本",-1),x={href:"https://github.com/rancher/rancher/releases/tag/v2.8.2",target:"_blank",rel:"noopener noreferrer"},R=r(`<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>https://github.com/rancher/rancher/releases/tag/v2.8.2
CLI - v2.8.0
RKE - v1.5.3
Kubernetes Versions
    v1.27.8 (Default)
    v1.26.11
    v1.25.16

https://github.com/rancher/rancher/releases/tag/v2.7.11
CLI - v2.7.7
RKE - v1.4.15
Kubernetes Versions
    v1.27.10 (Default)
    v1.26.13
    v1.25.16
    v1.24.17
    （RKE：v1.23.16、RKE2/K3s：v1.23.17）

https://github.com/rancher/rancher/releases/tag/v2.6.7
Kubernetes Versions
    v1.24.2 (Default)
    v1.23.8
    v1.22.11
    v1.21.14
    v1.20.15
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="docker安装" tabindex="-1"><a class="header-anchor" href="#docker安装"><span>docker安装</span></a></h2><p>v2.6.7、v2.8.2</p><p>docker pull rancher/rancher:v2.8.2</p>`,4),E={href:"http://registry.cn-chengdu.aliyuncs.com/k8sjf/rancher:v2.8.2",target:"_blank",rel:"noopener noreferrer"},j={href:"http://registry.cn-chengdu.aliyuncs.com/k8sjf/rancher:v2.8.2",target:"_blank",rel:"noopener noreferrer"},C=r(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--privileged</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">--restart</span><span class="token operator">=</span>unless-stopped <span class="token parameter variable">-p</span> <span class="token number">8988</span>:80 <span class="token parameter variable">-p</span> <span class="token number">4430</span>:443 registry.cn-chengdu.aliyuncs.com/k8sjf/rancher:v2.8.2

<span class="token comment"># docker-compose方式</span>
<span class="token function">git</span> clone https://gitee.com/zhengqingya/docker-compose.git
<span class="token builtin class-name">cd</span> docker-compose/Liunx
<span class="token function">docker-compose</span> <span class="token parameter variable">-f</span> docker-compose-rancher.yml <span class="token parameter variable">-p</span> rancher up <span class="token parameter variable">-d</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>docker ps</p><p>docker logs cb08ec773b93 2&gt;&amp;1 | grep &quot;Bootstrap Password: &quot;</p><p><code>bd6trjjkplcx6d2lf4fxx78fpltprw5tb9n58vppjp2kkgkndk9qmt</code></p>`,4),H={href:"http://192.168.100.130:8988/",target:"_blank",rel:"noopener noreferrer"},S={href:"http://rancher.k8s.com:8988/",target:"_blank",rel:"noopener noreferrer"},L=e("h2",{id:"推荐安装",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#推荐安装"},[e("span",null,"推荐安装")])],-1),w={href:"https://docs.rancher.cn/docs/rancher2.5/installation/other-installation-methods/air-gap/install-rancher/_index#%E9%AB%98%E5%8F%AF%E7%94%A8%E5%AE%89%E8%A3%85%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89",target:"_blank",rel:"noopener noreferrer"},z=r(`<h3 id="先决条件" tabindex="-1"><a class="header-anchor" href="#先决条件"><span>先决条件</span></a></h3><ul><li>Kubernetes 集群</li><li>CLI</li><li>Ingress Controller</li></ul><h3 id="helm-chart-安装-rancher" tabindex="-1"><a class="header-anchor" href="#helm-chart-安装-rancher"><span>Helm Chart 安装 Rancher</span></a></h3><p>1、添加 Helm Chart 仓库</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>helm repo <span class="token function">add</span> rancher-latest https://releases.rancher.com/server-charts/latest
helm repo <span class="token function">add</span> rancher-stable https://releases.rancher.com/server-charts/stable
helm repo <span class="token function">add</span> rancher-alpha https://releases.rancher.com/server-charts/alpha

helm repo update
helm repo list
helm repo remove rancher-xx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、为 Rancher 创建 Namespace</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl create namespace cattle-system
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>3、选择你的 SSL 选项</p>`,8),A=e("thead",null,[e("tr",null,[e("th",null,"设置"),e("th",null,"Chart 选项"),e("th",null,"描述"),e("th",null,"是否需要 cert-manager")])],-1),K=e("tr",null,[e("td",null,"Rancher 生成的证书（默认）"),e("td",null,[e("code",null,"ingress.tls.source=rancher")]),e("td",null,[n("使用 Rancher 生成的 CA 签发的自签名证书此项为"),e("strong",null,"默认选项")]),e("td",null,"[是]")],-1),T=e("td",null,"Let’s Encrypt",-1),D=e("td",null,[e("code",null,"ingress.tls.source=letsEncrypt")],-1),q={href:"https://letsencrypt.org/",target:"_blank",rel:"noopener noreferrer"},N=e("td",null,"[是]",-1),B=e("tr",null,[e("td",null,"你已有的证书"),e("td",null,[e("code",null,"ingress.tls.source=secret")]),e("td",null,"使用你的自己的证书（Kubernetes 密文）"),e("td",null,"否")],-1),V=e("blockquote",null,[e("p",null,[n("Rancher 中国技术支持团队建议你使用“你已有的证书” "),e("code",null,"ingress.tls.source=secret"),n(" 这种方式，从而减少对 cert-manager 的运维成本。")])],-1),Z=e("p",null,"4、安装 cert-manager",-1),I={href:"https://github.com/jetstack/cert-manager/releases",target:"_blank",rel:"noopener noreferrer"},P=r(`<p>仅在使用 Rancher 生成的证书 <code>ingress.tls.source=rancher</code> 或 Let&#39;s Encrypt 颁发的证书 <code>ingress.tls.source=letsEncrypt</code>时才需要 cert-manager。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>
<span class="token comment"># 如果你手动安装了CRD，而不是在Helm安装命令中添加了\`--set installCRDs=true\`选项，你应该在升级Helm chart之前升级CRD资源。</span>
<span class="token function">wget</span> https://github.com/jetstack/cert-manager/releases/download/v1.9.1/cert-manager.crds.yaml
kubectl apply <span class="token parameter variable">-f</span> cert-manager.crds.yaml

<span class="token comment"># 添加 Jetstack Helm 仓库</span>

helm repo <span class="token function">add</span> jetstack https://charts.jetstack.io

<span class="token comment"># 更新本地 Helm chart 仓库缓存</span>

helm repo update

<span class="token comment"># 安装 cert-manager Helm chart</span>

helm <span class="token function">install</span> cert-manager jetstack/cert-manager <span class="token punctuation">\\</span>
  <span class="token parameter variable">--namespace</span> cert-manager <span class="token punctuation">\\</span>
  --create-namespace <span class="token punctuation">\\</span>
  <span class="token parameter variable">--version</span> v1.9.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装完 cert-manager 后，你可以通过检查 cert-manager 命名空间中正在运行的 Pod 来验证它是否已正确部署：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl get pods <span class="token parameter variable">--namespace</span> cert-manager

NAME                                       READY   STATUS    RESTARTS   AGE
cert-manager-5c6866597-zw7kh               <span class="token number">1</span>/1     Running   <span class="token number">0</span>          2m
cert-manager-cainjector-577f6d9fd7-tr77l   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          2m
cert-manager-webhook-787858fcdb-nlzsq      <span class="token number">1</span>/1     Running   <span class="token number">0</span>          2m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5、根据你选择的 SSL 选项，通过 Helm 安装 Rancher</p><p>因为 <code>rancher</code> 是 <code>ingress.tls.source</code> 的默认选项，所以在运行 <code>helm install</code> 命令时我们没有指定 <code>ingress.tls.source</code>。</p><ul><li>将 <code>hostname</code> 设置为解析到你的负载均衡器的 DNS 记录。Rancher HA 安装成功后，你需要通过这个域名来访问 Rancher Server。</li><li>将 <code>replicas</code> 设置为 Rancher 部署所使用的副本数量。默认为 3；如果集群中的节点少于 3 个，你应该相应地减少副本数量。</li><li>要安装一个特定的 Rancher 版本，使用 <code>--version</code> 标志，例如：<code>--version 2.3.6</code>。</li><li>如果你安装的是 alpha 版本，Helm 要求在命令中加入 <code>--devel</code> 选项。</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>helm <span class="token function">install</span> rancher rancher-/rancher <span class="token punctuation">\\</span>
  <span class="token parameter variable">--namespace</span> cattle-system <span class="token punctuation">\\</span>
  <span class="token parameter variable">--set</span> <span class="token assign-left variable">hostname</span><span class="token operator">=</span>rancher.k8s.com <span class="token punctuation">\\</span>
  <span class="token parameter variable">--version</span> <span class="token number">2.6</span>.7
  <span class="token parameter variable">--set</span> <span class="token assign-left variable">replicas</span><span class="token operator">=</span><span class="token number">3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl <span class="token parameter variable">-n</span> cattle-system rollout status deploy/rancher
Waiting <span class="token keyword">for</span> deployment <span class="token string">&quot;rancher&quot;</span> rollout to finish: <span class="token number">0</span> of <span class="token number">3</span> updated replicas are available<span class="token punctuation">..</span>.
deployment <span class="token string">&quot;rancher&quot;</span> successfully rolled out
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6、验证 Rancher Server 是否已成功部署</p><p>7、保存你的选项</p><p>安装完成</p><h2 id="离线安装" tabindex="-1"><a class="header-anchor" href="#离线安装"><span>离线安装</span></a></h2><h3 id="配置-helm-chart-仓库" tabindex="-1"><a class="header-anchor" href="#配置-helm-chart-仓库"><span>配置 Helm Chart 仓库</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>helm repo <span class="token function">add</span> rancher-latest https://releases.rancher.com/server-charts/latest
helm repo <span class="token function">add</span> rancher-stable https://releases.rancher.com/server-charts/stable
helm repo <span class="token function">add</span> rancher-alpha https://releases.rancher.com/server-charts/alpha

helm repo update
helm repo list
helm repo remove rancher-xx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="下载tgz安装包" tabindex="-1"><a class="header-anchor" href="#下载tgz安装包"><span>下载tgz安装包</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#搜索</span>
helm search repo rancher-latest <span class="token operator">|</span> <span class="token function">grep</span> rancher
<span class="token comment">#下载指定仓库版本tgz文件</span>
helm pull rancher-latest/rancher
<span class="token comment">#指定版本下载</span>
helm pull rancher-latest/rancher <span class="token parameter variable">--version</span><span class="token operator">=</span>v2.8.2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ssl-配置" tabindex="-1"><a class="header-anchor" href="#ssl-配置"><span>SSL 配置</span></a></h3><h3 id="离线环境可用的-helm-chart-选项" tabindex="-1"><a class="header-anchor" href="#离线环境可用的-helm-chart-选项"><span>离线环境可用的 Helm Chart 选项</span></a></h3><h3 id="渲染您的-rancher-helm-模板" tabindex="-1"><a class="header-anchor" href="#渲染您的-rancher-helm-模板"><span>渲染您的 Rancher Helm 模板</span></a></h3>`,20),F={href:"https://charts.jetstack.io",target:"_blank",rel:"noopener noreferrer"},M=r(`<p>helm repo update</p><h3 id="安装-rancher" tabindex="-1"><a class="header-anchor" href="#安装-rancher"><span>安装 Rancher</span></a></h3><h2 id="使用-kubectl-安装-rancher" tabindex="-1"><a class="header-anchor" href="#使用-kubectl-安装-rancher"><span>使用 kubectl 安装 Rancher</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl create namespace cattle-system
kubectl <span class="token parameter variable">-n</span> cattle-system apply <span class="token parameter variable">-R</span> <span class="token parameter variable">-f</span> ./rancher
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,4);function J(O,W){const a=t("ExternalLinkIcon");return c(),i("div",null,[h,p,e("ul",null,[e("li",null,[e("a",u,[n("https://rancher.com/"),s(a)])]),e("li",null,[e("a",m,[n("https://www.rancher.cn/"),s(a)])]),e("li",null,[e("a",v,[n("https://github.com/rancher/rancher"),s(a)]),n(),b]),e("li",null,[e("a",g,[n("https://gitee.com/k8s_s/rancher"),s(a)])]),e("li",null,[e("a",k,[n("https://hub.docker.com/r/rancher/rancher/tags"),s(a)])])]),_,f,y,e("p",null,[e("a",x,[n("rancher/releases/tag/v2.8.2"),s(a)])]),R,e("p",null,[n("docker tag rancher/rancher:v2.8.2 "),e("a",E,[n("registry.cn-chengdu.aliyuncs.com/k8sjf/rancher:v2.8.2"),s(a)])]),e("p",null,[n("docker push "),e("a",j,[n("registry.cn-chengdu.aliyuncs.com/k8sjf/rancher:v2.8.2"),s(a)])]),C,e("p",null,[e("a",H,[n("http://192.168.100.130:8988/"),s(a)])]),e("p",null,[e("a",S,[n("http://rancher.k8s.com:8988/"),s(a)])]),L,e("p",null,[e("a",w,[n("高可用安装（推荐）"),s(a)])]),z,e("table",null,[A,e("tbody",null,[K,e("tr",null,[T,D,e("td",null,[n("使用"),e("a",q,[n("Let's Encrypt"),s(a)]),n("颁发的证书")]),N]),B])]),V,Z,e("p",null,[e("a",I,[n("https://github.com/jetstack/cert-manager/releases"),s(a)])]),P,e("p",null,[n("helm repo add jetstack "),e("a",F,[n("https://charts.jetstack.io"),s(a)])]),M])}const Y=l(o,[["render",J],["__file","rancher.html.vue"]]),Q=JSON.parse('{"path":"/k8s/rancher.html","title":"k8s 可视化管理工具-Rancher","lang":"zh-CN","frontmatter":{"icon":"/icons/k8s/k8s_16x16.png","title":"k8s 可视化管理工具-Rancher","category":["kubernetes"],"headerDepth":5,"date":"2022-08-24T00:00:00.000Z","order":10,"tag":["Linux","k8s"],"description":"k8s 可视化管理工具-Rancher","head":[["meta",{"property":"og:url","content":"https://blogres.github.io/k8s/rancher.html"}],["meta",{"property":"og:title","content":"k8s 可视化管理工具-Rancher"}],["meta",{"property":"og:description","content":"k8s 可视化管理工具-Rancher"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-06T13:59:11.000Z"}],["meta",{"property":"article:author","content":"blogres"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:tag","content":"k8s"}],["meta",{"property":"article:published_time","content":"2022-08-24T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-06T13:59:11.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"k8s 可视化管理工具-Rancher\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-08-24T00:00:00.000Z\\",\\"dateModified\\":\\"2024-03-06T13:59:11.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"blogres\\",\\"url\\":\\"/article\\"}]}"]]},"headers":[{"level":2,"title":"安装2.8.2","slug":"安装2-8-2","link":"#安装2-8-2","children":[]},{"level":2,"title":"docker安装","slug":"docker安装","link":"#docker安装","children":[]},{"level":2,"title":"推荐安装","slug":"推荐安装","link":"#推荐安装","children":[{"level":3,"title":"先决条件","slug":"先决条件","link":"#先决条件","children":[]},{"level":3,"title":"Helm Chart 安装 Rancher","slug":"helm-chart-安装-rancher","link":"#helm-chart-安装-rancher","children":[]}]},{"level":2,"title":"离线安装","slug":"离线安装","link":"#离线安装","children":[{"level":3,"title":"配置 Helm Chart 仓库","slug":"配置-helm-chart-仓库","link":"#配置-helm-chart-仓库","children":[]},{"level":3,"title":"下载tgz安装包","slug":"下载tgz安装包","link":"#下载tgz安装包","children":[]},{"level":3,"title":"SSL 配置","slug":"ssl-配置","link":"#ssl-配置","children":[]},{"level":3,"title":"离线环境可用的 Helm Chart 选项","slug":"离线环境可用的-helm-chart-选项","link":"#离线环境可用的-helm-chart-选项","children":[]},{"level":3,"title":"渲染您的 Rancher Helm 模板","slug":"渲染您的-rancher-helm-模板","link":"#渲染您的-rancher-helm-模板","children":[]},{"level":3,"title":"安装 Rancher","slug":"安装-rancher","link":"#安装-rancher","children":[]}]},{"level":2,"title":"使用 kubectl 安装 Rancher","slug":"使用-kubectl-安装-rancher","link":"#使用-kubectl-安装-rancher","children":[]}],"git":{"createdTime":1706536810000,"updatedTime":1709733551000,"contributors":[{"name":"topjfy","email":"topjfk@163.com","commits":5}]},"readingTime":{"minutes":3.88,"words":1163},"filePathRelative":"k8s/rancher.md","localizedDate":"2022年8月24日","excerpt":"<p>k8s 可视化管理工具-Rancher</p>\\n","autoDesc":true}');export{Y as comp,Q as data};
