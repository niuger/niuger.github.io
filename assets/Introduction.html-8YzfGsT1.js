import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as c,c as o,b as n,e as a,d as s,w as u,a as e}from"./app-D1uezr0R.js";const r="/assets/true-image-20211207225032232-C-_TmQM-.png",d="/assets/true-image-20211207225209670-Dfvz4-c7.png",k="/assets/true-image-20211207225504118-Bi-ciJLL.png",m="/assets/true-image-20211207225722559-DOoyq66W.png",v="/assets/true-image-20211207230129356-ClDPDIte.png",b="/assets/true-image-20211207231251942-BnpJH66f.png",g="/assets/true-image-20211207231314338-B50GvPQL.png",y="/assets/true-image-20211207231849655-PC-m4Bb_.png",h="/assets/true-image-20211208174133284-BvbSjovb.png",f="/assets/true-image-20211208175833308-CTo2zUQM.png",x="/assets/true-image-20211208180527896-DmCD-vm0.png",_="/assets/true-image-20211208181306441-B5xmu4e1.png",P="/assets/true-image-20211208212559503-C5TPOO6a.png",E="/assets/true-image-20211208215629869-1bgZEHnN.png",A="/assets/true-image-20211208220838638-BKIDu3ok.png",T="/assets/components-of-kubernetes-PGxKOYLl.svg",D="/assets/true-image-20211208203943489-Cko0vcs2.png",C="/assets/true-image-20211208205239059-C_8APvWq.png",N="/assets/true-2839691-20220421215548249-23947997-homi3vAc.png",I="/assets/true-image-20211208205421842-C7d9jhSP.png",B="/assets/true-image-20211208205753063-CTxXc6Pa.png",R="/assets/true-image-20211208205714089-D_1pnt31.png",z={},S=n("p",null,"k8s入门体验：kubectl命令使用、yaml文件配置、Deployment与service概念",-1),L=n("h2",{id:"k8s入门篇",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#k8s入门篇"},[n("span",null,"k8s入门篇")])],-1),w=n("p",null,[a("后期yaml文件参考可直接到这里开始复习吧："),n("a",{href:"#_2%E3%80%81%E4%BD%BF%E7%94%A8apps-%E6%9A%B4%E9%9C%B2service-port%E7%9A%84yaml%E6%A0%BC%E5%BC%8F"},"使用[apps+暴露Service port]的yaml格式")],-1),j=n("p",null,[n("strong",null,"资源包括(不区分大小写)：pod（po），service（svc），replication controller（rc），deployment（deploy），replica set（rs）")],-1),V=e(`<h3 id="kubectl-get-po" tabindex="-1"><a class="header-anchor" href="#kubectl-get-po"><span>kubectl get po</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master-120 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get po</span>
NAME                      READY   STATUS    RESTARTS      AGE
nginx-689b55fcd-2c8v8     <span class="token number">1</span>/1     Running   <span class="token number">1</span> <span class="token punctuation">(</span>19h ago<span class="token punctuation">)</span>   19h
nginx-689b55fcd-5qpkp     <span class="token number">1</span>/1     Running   <span class="token number">1</span> <span class="token punctuation">(</span>19h ago<span class="token punctuation">)</span>   19h
nginx-689b55fcd-gpdqz     <span class="token number">1</span>/1     Running   <span class="token number">1</span> <span class="token punctuation">(</span>19h ago<span class="token punctuation">)</span>   19h
tomcat-549f8d66bc-bln66   <span class="token number">1</span>/1     Running   <span class="token number">1</span> <span class="token punctuation">(</span>19h ago<span class="token punctuation">)</span>   19h
tomcat-549f8d66bc-rqhvm   <span class="token number">1</span>/1     Running   <span class="token number">1</span> <span class="token punctuation">(</span>19h ago<span class="token punctuation">)</span>   19h
tomcat-549f8d66bc-zkc94   <span class="token number">1</span>/1     Running   <span class="token number">1</span> <span class="token punctuation">(</span>19h ago<span class="token punctuation">)</span>   19h
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kubectl-get-svc" tabindex="-1"><a class="header-anchor" href="#kubectl-get-svc"><span>kubectl get svc</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master-120 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get svc</span>
NAME         TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>    AGE
kubernetes   ClusterIP   <span class="token number">10.96</span>.0.1      <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP    29h
nginx        ClusterIP   <span class="token number">10.96</span>.99.230   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">8000</span>/TCP   19h
tomcat       ClusterIP   <span class="token number">10.96</span>.102.96   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">8001</span>/TCP   19h
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kubectl-get-rc" tabindex="-1"><a class="header-anchor" href="#kubectl-get-rc"><span>kubectl get rc</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>No resources found <span class="token keyword">in</span> default namespace.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="kubectl-get-deploy" tabindex="-1"><a class="header-anchor" href="#kubectl-get-deploy"><span>kubectl get deploy</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master-120 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get deploy</span>
NAME     READY   UP-TO-DATE   AVAILABLE   AGE
nginx    <span class="token number">3</span>/3     <span class="token number">3</span>            <span class="token number">3</span>           19h
tomcat   <span class="token number">3</span>/3     <span class="token number">3</span>            <span class="token number">3</span>           19h
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kubectl-get-rs" tabindex="-1"><a class="header-anchor" href="#kubectl-get-rs"><span>kubectl get rs</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master-120 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get rs</span>
NAME                DESIRED   CURRENT   READY   AGE
nginx-689b55fcd     <span class="token number">3</span>         <span class="token number">3</span>         <span class="token number">3</span>       19h
tomcat-549f8d66bc   <span class="token number">3</span>         <span class="token number">3</span>         <span class="token number">3</span>       19h
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="a、基本命令" tabindex="-1"><a class="header-anchor" href="#a、基本命令"><span>A、基本命令</span></a></h3><h4 id="_1、创建apps-create-deployment" tabindex="-1"><a class="header-anchor" href="#_1、创建apps-create-deployment"><span>1、创建apps：create deployment</span></a></h4><p>master安装tomcat</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl create deployment tomcat6 <span class="token parameter variable">--image</span><span class="token operator">=</span>tomcat:6.0.53-jre8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_2、查看-kg-all" tabindex="-1"><a class="header-anchor" href="#_2、查看-kg-all"><span>2、查看 kg all</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>a1@node01:~/k8s$ kubectl get all
NAME                           READY   STATUS              RESTARTS     AGE
pod/tomcat6-56fcc999cb-47vfm   <span class="token number">0</span>/1     ContainerCreating      <span class="token number">0</span>         23s
NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>      AGE
service/kubernetes   ClusterIP   <span class="token number">10.96</span>.0.1    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP     115m
NAME                      READY   UP-TO-DATE   AVAILABLE        AGE
deployment.apps/tomcat6   <span class="token number">0</span>/1       <span class="token number">1</span>             <span class="token number">0</span>               23s
NAME                                 DESIRED   CURRENT   READY     AGE
replicaset.apps/tomcat6-56fcc999cb   <span class="token number">1</span>         <span class="token number">1</span>         <span class="token number">0</span>         23s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3、查看详细-kg-all-o-wide" tabindex="-1"><a class="header-anchor" href="#_3、查看详细-kg-all-o-wide"><span>3、查看详细 kg all -o wide</span></a></h4><p>tomcat6在节点node2---docker下载镜像ok</p><figure><img src="`+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在node2查看</p><figure><img src="'+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="'+k+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_4、查看-kg-pod-o-wide" tabindex="-1"><a class="header-anchor" href="#_4、查看-kg-pod-o-wide"><span>4、查看 kg pod -o wide</span></a></h4><figure><img src="'+m+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h5 id="node02模拟宕机-看看k8s怎么处理-dkstop与node02关机" tabindex="-1"><a class="header-anchor" href="#node02模拟宕机-看看k8s怎么处理-dkstop与node02关机"><span>node02模拟宕机，看看k8s怎么处理（dkstop与node02关机）</span></a></h5><figure><img src="'+v+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>发现node2节点已经不行了，全部压力到了node3</p><figure><img src="'+b+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="'+g+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h5 id="重启-node02" tabindex="-1"><a class="header-anchor" href="#重启-node02"><span>重启 node02</span></a></h5><figure><img src="'+y+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_5、暴露port-expose" tabindex="-1"><a class="header-anchor" href="#_5、暴露port-expose"><span>5、暴露port：expose</span></a></h4><blockquote><p>expose (-f FILENAME | TYPE NAME) [--port=port] [--protocol=TCP|UDP] [--target-port=number-or-name] [--name=name] [--external-ip=external-ip-of-service] [--type=type]</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl expose rc nginx <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token number">80</span> --target-port<span class="token operator">=</span><span class="token number">8080</span>
kubectl expose deploy tomcat6 <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token number">80</span> --target-port<span class="token operator">=</span><span class="token number">8080</span> <span class="token parameter variable">--type</span><span class="token operator">=</span>NodePort
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="'+f+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',36),q={href:"http://192.168.100.131:31002/",target:"_blank",rel:"noopener noreferrer"},M=e(`<h4 id="_6、修改port-edit" tabindex="-1"><a class="header-anchor" href="#_6、修改port-edit"><span>6、修改port：edit</span></a></h4><p>修改app应用服务的port：<code>kubectl edit svc tomcat6</code></p><p>修改app应用：<code>kubectl edit deploy tomcat6</code></p><h4 id="_7、扩容或缩容-scale" tabindex="-1"><a class="header-anchor" href="#_7、扩容或缩容-scale"><span>7、扩容或缩容：scale</span></a></h4><blockquote><p>scale [--resource-version=version] [--current-replicas=count] --replicas=COUNT (-f FILENAME | TYPE NAME)</p></blockquote><p>将名为tomcat6中的pod副本数设置为3。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl scale <span class="token parameter variable">--replicas</span><span class="token operator">=</span><span class="token number">3</span> deployment tomcat6
kg pods <span class="token parameter variable">-o</span> wide
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+x+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>如果当前副本数为2，则将其扩展至3。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl scale --current-replicas<span class="token operator">=</span><span class="token number">2</span> <span class="token parameter variable">--replicas</span><span class="token operator">=</span><span class="token number">3</span> deployment/tomcat6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_8、删除以-create-deployment-部署的-apps、service-delete" tabindex="-1"><a class="header-anchor" href="#_8、删除以-create-deployment-部署的-apps、service-delete"><span>8、删除以 create deployment 部署的(apps、service) delete</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl  get all
kubectl delete deployment.apps/tomcat6
kubectl delete service/tomcat6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+_+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_9、部署-删除以-yaml-部署的实例" tabindex="-1"><a class="header-anchor" href="#_9、部署-删除以-yaml-部署的实例"><span>9、部署&amp;删除以 yaml 部署的实例</span></a></h4><p><a href="#xxx-yaml">查看 xxx.yaml</a></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl apply <span class="token parameter variable">-f</span> xxx.yaml

kubectl delete <span class="token parameter variable">-f</span> xxx.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="b、yaml-基本使用" tabindex="-1"><a class="header-anchor" href="#b、yaml-基本使用"><span>B、yaml &amp; 基本使用</span></a></h3>`,17),O={href:"https://kubernetes.io/zh/docs/reference/kubectl/overview/",target:"_blank",rel:"noopener noreferrer"},U=e(`<p>后期使用：<a href="#_2%E3%80%81%E4%BD%BF%E7%94%A8apps-%E6%9A%B4%E9%9C%B2service-port%E7%9A%84yaml%E6%A0%BC%E5%BC%8F">使用[apps+暴露Service port]的yaml格式</a>，而不是使用 <a href="#_1%E3%80%81%E5%88%9D%E7%BA%A7%E4%BD%BF%E7%94%A8yaml%E5%88%9B%E5%BB%BAapps">初级使用yaml创建apps</a></p><h4 id="pod-模版" tabindex="-1"><a class="header-anchor" href="#pod-模版"><span>Pod 模版</span></a></h4><p>一般不会自己创建</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat9<span class="token punctuation">-</span><span class="token number">02</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat9<span class="token punctuation">-</span><span class="token number">02</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>6.0.53<span class="token punctuation">-</span>jre8
    <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
    <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat9<span class="token punctuation">-</span><span class="token number">02</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="deployment-模版" tabindex="-1"><a class="header-anchor" href="#deployment-模版"><span>Deployment 模版</span></a></h4><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat601
  <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat601<span class="token punctuation">-</span>deployment
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token comment">#replicas复制几份</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span> 
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat601
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token comment">#Pod模板</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat601
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>6.0.53<span class="token punctuation">-</span>jre8
        <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat601
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
  <span class="token comment">#Pod模板</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token comment">#Pod模板规约：spec-指示 Pods 运行一个 nginx 容器</span>
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>1.14.2
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="service-模版" tabindex="-1"><a class="header-anchor" href="#service-模版"><span>Service 模版</span></a></h4><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat601
  <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat601<span class="token punctuation">-</span>xxx<span class="token punctuation">-</span>jp3sk
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token comment">#- NodePort: 30965</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat601
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1、初级使用yaml创建apps" tabindex="-1"><a class="header-anchor" href="#_1、初级使用yaml创建apps"><span>1、初级使用yaml创建apps</span></a></h4><p><strong>后期不推荐使用这种方式</strong></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 使用 example-service.yaml 中的定义创建服务。</span>
kubectl apply <span class="token parameter variable">-f</span> example-service.yaml

<span class="token comment"># 使用 example-controller.yaml 中的定义创建 replication controller。</span>
kubectl apply <span class="token parameter variable">-f</span> example-controller.yaml

<span class="token comment"># 使用 &lt;directory&gt; 路径下的任意 .yaml, .yml, 或 .json 文件 创建对象。</span>
kubectl apply <span class="token parameter variable">-f</span> <span class="token operator">&lt;</span>directory<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看并保存 Deployment 的 yaml 文件（--dry-run）</p><blockquote><p>--dry-run：仅查看不运行</p><p>kubectl create deployment [服务名称]--image=[镜像名称] --dry-run -o yaml &gt; [保存目标]</p><p>kubectl create deployment tomcat6 --image=tomcat:6.0.53-jre8 --dry-run -o yaml &gt; tomcat6.yaml</p></blockquote><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat6
  <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat6
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat6
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat6
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>6.0.53<span class="token punctuation">-</span>jre8
        <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建 Deployment apps：<code>kubectl apply -f tomcat6.yaml</code></p><p>查看deployments信息：<code>kubectl get deployments</code></p><p>更新 Deployment</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl <span class="token builtin class-name">set</span> image deployment.v1.apps/tomcat6 <span class="token assign-left variable">tomcat</span><span class="token operator">=</span>tomcat:9.0.53-jre8
或
kubectl <span class="token builtin class-name">set</span> image deployment/tomcat6 <span class="token assign-left variable">tomcat</span><span class="token operator">=</span>tomcat:9.0.53-jre8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>回滚 Deployment</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl <span class="token builtin class-name">set</span> image deployment/tomcat6 <span class="token assign-left variable">tomcat</span><span class="token operator">=</span>tomcat:9.0.53-jre8 <span class="token parameter variable">--record</span><span class="token operator">=</span>true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>暴露 service 端口：<code>kubectl expose deploy tomcat6 --port=80 --target-port=8080 --type=NodePort</code></p><p>查看 Pod（<code>kg all</code> ，<code>kg pods -o wide</code>，<code>kg pod xx -o yaml</code>）</p><figure><img src="`+P+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat6
    <span class="token key atrule">pod-template-hash</span><span class="token punctuation">:</span> 56fcc999cb
  <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat6<span class="token punctuation">-</span>56fcc999cb<span class="token punctuation">-</span>nm2nx
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token key atrule">ownerReferences</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
    <span class="token key atrule">blockOwnerDeletion</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">controller</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">kind</span><span class="token punctuation">:</span> ReplicaSet
    <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat6<span class="token punctuation">-</span>56fcc999cb
    <span class="token key atrule">uid</span><span class="token punctuation">:</span> 28633fd6<span class="token punctuation">-</span>b3ee<span class="token punctuation">-</span>45aa<span class="token punctuation">-</span>93d5<span class="token punctuation">-</span>fb8931735029
  <span class="token key atrule">resourceVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;47929&quot;</span>
  <span class="token key atrule">uid</span><span class="token punctuation">:</span> 59333abe<span class="token punctuation">-</span>6a24<span class="token punctuation">-</span>4995<span class="token punctuation">-</span>888b<span class="token punctuation">-</span>88577fef9559
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>6.0.53<span class="token punctuation">-</span>jre8
    <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
    <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat
<span class="token punctuation">...</span> <span class="token punctuation">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>自己创建 pod（yaml）文件，Pod 通常不是直接创建的，而是使用工作负载资源创建的。</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
   <span class="token comment">#实例名称</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat601
  <span class="token comment">#容器名称  </span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span>  tomcat6<span class="token punctuation">-</span>xxx<span class="token punctuation">-</span>wzfj2
  <span class="token comment">#命名空间</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token comment">#容器</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>6.0.53<span class="token punctuation">-</span>jre8
    <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
    <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat601
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建Pod实例：<code>kubectl apply -f myPod.yaml</code></p><p>查看 Service（<code>kg svc tomcat6 -o yaml</code>）</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token string">&quot;2021-12-08T13:41:18Z&quot;</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat6
  <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat6
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token key atrule">resourceVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;48461&quot;</span>
  <span class="token key atrule">uid</span><span class="token punctuation">:</span> b4ebfb65<span class="token punctuation">-</span>4e0c<span class="token punctuation">-</span>478a<span class="token punctuation">-</span>8e85<span class="token punctuation">-</span>f03acef2d166
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">clusterIP</span><span class="token punctuation">:</span> 10.96.126.87
  <span class="token key atrule">clusterIPs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> 10.96.126.87
  <span class="token key atrule">externalTrafficPolicy</span><span class="token punctuation">:</span> Cluster
  <span class="token key atrule">internalTrafficPolicy</span><span class="token punctuation">:</span> Cluster
  <span class="token key atrule">ipFamilies</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> IPv4
  <span class="token key atrule">ipFamilyPolicy</span><span class="token punctuation">:</span> SingleStack
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">nodePort</span><span class="token punctuation">:</span> <span class="token number">31005</span> <span class="token comment">#暴露给外部使用port</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat6
  <span class="token key atrule">sessionAffinity</span><span class="token punctuation">:</span> None
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
<span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token key atrule">loadBalancer</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看 Deployment-apps（<code>kg deploy tomcat6 -o yaml</code>）</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat6
  <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat6
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token punctuation">...</span>
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat6
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat6
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>6.0.53<span class="token punctuation">-</span>jre8
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
        <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat
        <span class="token key atrule">terminationMessagePath</span><span class="token punctuation">:</span> /dev/termination<span class="token punctuation">-</span>log
        <span class="token key atrule">terminationMessagePolicy</span><span class="token punctuation">:</span> File
   <span class="token punctuation">...</span>.
<span class="token key atrule">status</span><span class="token punctuation">:</span>
    <span class="token punctuation">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看 Deployment 上线状态：<code>kubectl rollout status deployment/nginx-deployment</code></p>`,33),Y={href:"http://192.168.100.130:80/",target:"_blank",rel:"noopener noreferrer"},F=e('<figure><img src="'+E+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2、使用apps-暴露service-port的yaml格式" tabindex="-1"><a class="header-anchor" href="#_2、使用apps-暴露service-port的yaml格式"><span>2、使用apps+暴露Service-port的yaml格式</span></a></h4><p><strong>安装Deployment（apps）与暴露Service（expose-port）在同一个yaml文件里设置，通过<code>---</code>分隔</strong></p><h5 id="xxx-yaml" tabindex="-1"><a class="header-anchor" href="#xxx-yaml"><span>xxx.yaml</span></a></h5><details class="hint-container details"><summary>点击查看代码</summary><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat
  <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat
        <span class="token key atrule">image</span><span class="token punctuation">:</span> registry.cn<span class="token punctuation">-</span>chengdu.aliyuncs.com/k8sjf/tomcat<span class="token punctuation">:</span>9.0.62<span class="token punctuation">-</span>jre11<span class="token punctuation">-</span>temurin<span class="token punctuation">-</span>focal
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat
  <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> tomcat
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><figure><img src="`+A+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="c、deployment-service-概念" tabindex="-1"><a class="header-anchor" href="#c、deployment-service-概念"><span>C、Deployment &amp; service 概念</span></a></h3><figure><img src="'+T+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="pod-service" tabindex="-1"><a class="header-anchor" href="#pod-service"><span>pod&amp;service</span></a></h4><figure><img src="'+D+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="'+C+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>将一组pod公开为网络服务，通过service代理，可以实现负载均衡</p><figure><img src="'+N+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="clusterip" tabindex="-1"><a class="header-anchor" href="#clusterip"><span>ClusterIP</span></a></h4><p>此方式只能在集群内访问</p><h4 id="label-selector" tabindex="-1"><a class="header-anchor" href="#label-selector"><span>label&amp;selector</span></a></h4><figure><img src="'+I+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>通讯1</p><figure><img src="'+B+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>通讯2</p><figure><img src="'+R+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="说明" tabindex="-1"><a class="header-anchor" href="#说明"><span>说明</span></a></h4><blockquote><p>一个集群或多台mster、node，一个节点node，里面有多个Pod，一个Pod里可能有多个服务，各个Pod通过service暴露port给其他Pod、node之间是互通，通过controller来管理使用Pod资源。</p></blockquote><p>pod容器组有IP地址，而pod里的容器服务有port端口。</p><p>简单流程：node -&gt; pod -&gt; service -&gt; controller</p>',25);function G(Z,J){const p=l("RouteLink"),t=l("ExternalLinkIcon");return c(),o("div",null,[S,L,w,j,n("p",null,[a("具体命令请看："),s(p,{to:"/k8s/setting-alias.html"},{default:u(()=>[a("k8s-alias")]),_:1})]),V,n("p",null,[n("a",q,[a("http://192.168.100.131:31002/"),s(t)])]),M,n("p",null,[n("a",O,[a("https://kubernetes.io/zh/docs/reference/kubectl/overview/"),s(t)])]),U,n("p",null,[a("校验："),n("a",Y,[a("http://192.168.100.130:80/"),s(t)])]),F])}const H=i(z,[["render",G],["__file","Introduction.html.vue"]]),K=JSON.parse('{"path":"/k8s/Introduction.html","title":"k8s 入门篇","lang":"zh-CN","frontmatter":{"icon":"/icons/k8s/k8s_16x16.png","title":"k8s 入门篇","category":["kubernetes"],"headerDepth":5,"date":"2020-04-20T00:00:00.000Z","order":4,"tag":["Linux","k8s"],"description":"k8s入门体验：kubectl命令使用、yaml文件配置、Deployment与service概念","head":[["meta",{"property":"og:url","content":"https://blogres.github.io/k8s/Introduction.html"}],["meta",{"property":"og:title","content":"k8s 入门篇"}],["meta",{"property":"og:description","content":"k8s入门体验：kubectl命令使用、yaml文件配置、Deployment与service概念"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-14T07:54:20.000Z"}],["meta",{"property":"article:author","content":"blogres"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:tag","content":"k8s"}],["meta",{"property":"article:published_time","content":"2020-04-20T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-14T07:54:20.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"k8s 入门篇\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2020-04-20T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-14T07:54:20.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"blogres\\",\\"url\\":\\"/article\\"}]}"]]},"headers":[{"level":2,"title":"k8s入门篇","slug":"k8s入门篇","link":"#k8s入门篇","children":[{"level":3,"title":"kubectl get po","slug":"kubectl-get-po","link":"#kubectl-get-po","children":[]},{"level":3,"title":"kubectl get svc","slug":"kubectl-get-svc","link":"#kubectl-get-svc","children":[]},{"level":3,"title":"kubectl get rc","slug":"kubectl-get-rc","link":"#kubectl-get-rc","children":[]},{"level":3,"title":"kubectl get deploy","slug":"kubectl-get-deploy","link":"#kubectl-get-deploy","children":[]},{"level":3,"title":"kubectl get rs","slug":"kubectl-get-rs","link":"#kubectl-get-rs","children":[]},{"level":3,"title":"A、基本命令","slug":"a、基本命令","link":"#a、基本命令","children":[{"level":4,"title":"1、创建apps：create deployment","slug":"_1、创建apps-create-deployment","link":"#_1、创建apps-create-deployment","children":[]},{"level":4,"title":"2、查看 kg all","slug":"_2、查看-kg-all","link":"#_2、查看-kg-all","children":[]},{"level":4,"title":"3、查看详细 kg all -o wide","slug":"_3、查看详细-kg-all-o-wide","link":"#_3、查看详细-kg-all-o-wide","children":[]},{"level":4,"title":"4、查看 kg pod -o wide","slug":"_4、查看-kg-pod-o-wide","link":"#_4、查看-kg-pod-o-wide","children":[{"level":5,"title":"node02模拟宕机，看看k8s怎么处理（dkstop与node02关机）","slug":"node02模拟宕机-看看k8s怎么处理-dkstop与node02关机","link":"#node02模拟宕机-看看k8s怎么处理-dkstop与node02关机","children":[]},{"level":5,"title":"重启 node02","slug":"重启-node02","link":"#重启-node02","children":[]}]},{"level":4,"title":"5、暴露port：expose","slug":"_5、暴露port-expose","link":"#_5、暴露port-expose","children":[]},{"level":4,"title":"6、修改port：edit","slug":"_6、修改port-edit","link":"#_6、修改port-edit","children":[]},{"level":4,"title":"7、扩容或缩容：scale","slug":"_7、扩容或缩容-scale","link":"#_7、扩容或缩容-scale","children":[]},{"level":4,"title":"8、删除以 create deployment 部署的(apps、service) delete","slug":"_8、删除以-create-deployment-部署的-apps、service-delete","link":"#_8、删除以-create-deployment-部署的-apps、service-delete","children":[]},{"level":4,"title":"9、部署&删除以 yaml 部署的实例","slug":"_9、部署-删除以-yaml-部署的实例","link":"#_9、部署-删除以-yaml-部署的实例","children":[]}]},{"level":3,"title":"B、yaml & 基本使用","slug":"b、yaml-基本使用","link":"#b、yaml-基本使用","children":[{"level":4,"title":"Pod 模版","slug":"pod-模版","link":"#pod-模版","children":[]},{"level":4,"title":"Deployment 模版","slug":"deployment-模版","link":"#deployment-模版","children":[]},{"level":4,"title":"Service 模版","slug":"service-模版","link":"#service-模版","children":[]},{"level":4,"title":"1、初级使用yaml创建apps","slug":"_1、初级使用yaml创建apps","link":"#_1、初级使用yaml创建apps","children":[]},{"level":4,"title":"2、使用apps+暴露Service-port的yaml格式","slug":"_2、使用apps-暴露service-port的yaml格式","link":"#_2、使用apps-暴露service-port的yaml格式","children":[{"level":5,"title":"xxx.yaml","slug":"xxx-yaml","link":"#xxx-yaml","children":[]}]}]},{"level":3,"title":"C、Deployment & service 概念","slug":"c、deployment-service-概念","link":"#c、deployment-service-概念","children":[{"level":4,"title":"pod&service","slug":"pod-service","link":"#pod-service","children":[]},{"level":4,"title":"ClusterIP","slug":"clusterip","link":"#clusterip","children":[]},{"level":4,"title":"label&selector","slug":"label-selector","link":"#label-selector","children":[]},{"level":4,"title":"说明","slug":"说明","link":"#说明","children":[]}]}]}],"git":{"createdTime":1709720858000,"updatedTime":1713081260000,"contributors":[{"name":"topjfy","email":"topjfk@163.com","commits":3}]},"readingTime":{"minutes":5.72,"words":1715},"filePathRelative":"k8s/Introduction.md","localizedDate":"2020年4月20日","excerpt":"<p>k8s入门体验：kubectl命令使用、yaml文件配置、Deployment与service概念</p>\\n","autoDesc":true}');export{H as comp,K as data};
